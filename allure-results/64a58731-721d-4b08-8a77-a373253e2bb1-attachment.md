# Test info

- Name: BlueDrop test cases >> Chatbot Screen >> TC_15: Create new session using "edit" icon button
- Location: D:\Playwright\Bluedrop_academy\tests\Chatbot.spec.ts:102:9

# Error details

```
Error: locator.click: Target page, context or browser has been closed
Call log:
  - waiting for locator('iframe[name="htmlComp-iframe"]').contentFrame().locator('[data-testid="new-session-click"]')
    - locator resolved to <button data-testid="new-session-click" class="bg-transparent border-0 p-0 m-0 new-session-start-btn">‚Ä¶</button>
  - attempting click action
    2 √ó waiting for element to be visible, enabled and stable
      - element is visible, enabled and stable
      - scrolling into view if needed
      - done scrolling
      - element is outside of the viewport
    - retrying click action
    - waiting 20ms
    2 √ó waiting for element to be visible, enabled and stable
      - element is visible, enabled and stable
      - scrolling into view if needed
      - done scrolling
      - element is outside of the viewport
    - retrying click action
      - waiting 100ms
    113 √ó waiting for element to be visible, enabled and stable
        - element is visible, enabled and stable
        - scrolling into view if needed
        - done scrolling
        - element is outside of the viewport
      - retrying click action
        - waiting 500ms

    at chatbotPage.NewsessionChatbotPage (D:\Playwright\Bluedrop_academy\tests\Pages\chatbotPage.ts:121:62)
    at D:\Playwright\Bluedrop_academy\tests\Chatbot.spec.ts:103:7
```

# Page snapshot

```yaml
- region "top of page"
- button "◊ú◊ì◊ú◊í ◊ú◊™◊ï◊õ◊ü ◊î◊®◊ê◊©◊ô"
- link "◊î◊ê◊™◊® ◊î◊ñ◊î ◊¢◊ï◊¶◊ë ◊ë◊¢◊ñ◊®◊™ ◊î◊õ◊ú◊ô ◊ú◊ë◊†◊ô◊ô◊™ ◊ê◊™◊®◊ô◊ù ◊©◊ú wix .com . ◊®◊ï◊¶◊ô◊ù ◊ú◊ô◊¶◊ï◊® ◊ê◊™◊® ◊û◊©◊ú◊õ◊ù? ◊î◊™◊ó◊ô◊ú◊ï ◊¢◊õ◊©◊ô◊ï":
  - /url: //www.wix.com/lpviral/enviral?utm_campaign=vir_wixad_live&orig_msid=d147380a-f3d1-419d-9ced-13400ea5a695&adsVersion=white
  - text: ◊î◊ê◊™◊® ◊î◊ñ◊î ◊¢◊ï◊¶◊ë ◊ë◊¢◊ñ◊®◊™ ◊î◊õ◊ú◊ô ◊ú◊ë◊†◊ô◊ô◊™ ◊ê◊™◊®◊ô◊ù ◊©◊ú
  - img "wix"
  - text: .com . ◊®◊ï◊¶◊ô◊ù ◊ú◊ô◊¶◊ï◊® ◊ê◊™◊® ◊û◊©◊ú◊õ◊ù? ◊î◊™◊ó◊ô◊ú◊ï ◊¢◊õ◊©◊ô◊ï
- main:
  - iframe
- region "bottom of page"
```

# Test source

```ts
   21 |     await expect(frameLocator.getByText('◊™◊ï◊ì◊î ◊¢◊ú ◊û◊°◊ô◊®◊™ ◊î◊§◊®◊ò◊ô◊ù ◊©◊ú◊ö')).toBeVisible();
   22 |     await expect(frameLocator.getByText("◊©◊ô◊ó◊ï◊™ ◊¢◊ù ◊ë◊ú◊ï")).toBeVisible();
   23 |   }
   24 |
   25 |   async InitialbotMessage() {
   26 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
   27 |     const messageLocator = frameLocator.locator(Chatbotlocator.InitialMessage);
   28 |
   29 |     console.log('üí¨ Waiting for initial bot message...');
   30 |     await expect
   31 |       .poll(async () => (await messageLocator.textContent())?.trim(), { timeout: 30000 })
   32 |       .not.toBe('');
   33 |     console.log('‚úÖ Initial bot message received.');
   34 |   }
   35 |
   36 |   async SubmitbtnNotActive() {
   37 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
   38 |     console.log('üîí Verifying Submit button is disabled...');
   39 |     await expect(frameLocator.locator(Chatbotlocator.SubmitBtn)).toBeDisabled();
   40 |   }
   41 |
   42 |   async SubmitbtnActive() {
   43 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
   44 |     this.userMessage = generateRandomQuestion();
   45 |     console.log(`üí¨ Typing message: ${this.userMessage}`);
   46 |
   47 |     await frameLocator.getByTestId('seach-msg-input').fill(this.userMessage);
   48 |
   49 |     console.log('‚úÖ Verifying Submit button is enabled...');
   50 |     await expect(frameLocator.locator(Chatbotlocator.SubmitBtn)).toBeEnabled();
   51 |   }
   52 |
   53 |   async PredefinebuttonNotActive() {
   54 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
   55 |     console.log('üîí Verifying predefined buttons are hidden...');
   56 |     await expect(frameLocator.locator('.main-chat-buttons-wrapper')).toBeHidden();
   57 |   }
   58 |
   59 |   async PredefinebuttonActive() {
   60 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
   61 |     console.log('üîì Verifying predefined buttons are visible...');
   62 |     await expect(frameLocator.locator('.main-chat-buttons-wrapper')).toBeVisible();
   63 |   }
   64 |
   65 |   async SubmitQuery(testInfo: TestInfo) {
   66 |     this.userMessage = generateRandomQuestion();
   67 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
   68 |     const input = frameLocator.getByTestId('seach-msg-input');
   69 |     const submitBtn = frameLocator.locator(Chatbotlocator.SubmitBtn);
   70 |
   71 |     console.log(`üí¨ Submitting query: "${this.userMessage}"`);
   72 |
   73 |     await input.clear();
   74 |     await input.fill(this.userMessage);
   75 |     await expect(submitBtn).toBeEnabled();
   76 |     await submitBtn.click();
   77 |
   78 |     console.log('üïê Waiting for bot response...');
   79 |     await this.page.waitForTimeout(9000);
   80 |
   81 |     const botMessages = await frameLocator.locator('.system-message-text').all();
   82 |     const lastMessage = botMessages[botMessages.length - 1];
   83 |     const botResponse = (await lastMessage.textContent())?.trim();
   84 |
   85 |     console.log(`‚úÖ Bot response received: "${botResponse}"`);
   86 |
   87 |     testInfo.annotations.push({
   88 |       type: 'info',
   89 |       description: `Bot response: ${botResponse}`,
   90 |     });
   91 |
   92 |     expect(botResponse).toBeTruthy();
   93 |   }
   94 |
   95 |   async scrollToBottom() {
   96 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
   97 |
   98 |     console.log('üîΩ Scrolling to bottom...');
   99 |     await this.page.waitForTimeout(5000);
  100 |
  101 |     await expect(frameLocator.locator(Chatbotlocator.ScrollingBtn)).toBeVisible();
  102 |     await frameLocator.locator(Chatbotlocator.ScrollingBtn).click();
  103 |     await expect(frameLocator.getByText(Chatbotlocator.VerifyBottomTxt)).toBeVisible();
  104 |   }
  105 |
  106 |   async Pagereload() {
  107 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
  108 |
  109 |     console.log('üîÑ Reloading and verifying bot session is cleared...');
  110 |     const botMessages = await frameLocator.locator('.system-message-text');
  111 |     await expect(botMessages).toHaveCount(0);
  112 |
  113 |     console.log('‚úÖ Verified: Bot responses are cleared after reload.');
  114 |   }
  115 |
  116 |   async NewsessionChatbotPage() {
  117 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
  118 |
  119 |     console.log('üîÅ Starting a new chatbot session...');
  120 |     await expect(frameLocator.locator(Chatbotlocator.NewsessionBtn)).toBeVisible();
> 121 |     await frameLocator.locator(Chatbotlocator.NewsessionBtn).click();
      |                                                              ^ Error: locator.click: Target page, context or browser has been closed
  122 |   }
  123 |
  124 |   async OpenHamburgerMenu() {
  125 |
  126 |
  127 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
  128 |     const menuButton = frameLocator.getByRole('button', { name: 'icon' }).nth(2);
  129 |
  130 |     console.log('üìÇ Opening hamburger menu...');
  131 |     await expect(menuButton).toBeVisible();
  132 |     await menuButton.click({ force: true });
  133 |
  134 |     await expect(frameLocator.getByRole('button', { name: 'Close' })).toBeVisible();
  135 |     await expect(frameLocator.getByTestId('start-new-session')).toBeVisible();
  136 |   }
  137 |
  138 |   async LoadmoreBtn() {
  139 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
  140 |
  141 |     console.log('üìú Clicking Load More button...');
  142 |     await expect(frameLocator.locator(Chatbotlocator.LoadMoreBtn)).toBeVisible();
  143 |     await frameLocator.locator(Chatbotlocator.LoadMoreBtn).click();
  144 |   }
  145 |
  146 |   async SearchHistory() {
  147 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
  148 |     console.log(`üîç Searching for message: "${this.userMessage}"`);
  149 |
  150 |     const input = frameLocator.locator(Chatbotlocator.Searchbar);
  151 |     await expect(input).toBeVisible();
  152 |     await input.click({ force: true });
  153 |     await input.fill(this.userMessage);
  154 |   }
  155 |
  156 |   async NoSearchHistory() {
  157 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
  158 |     const randomQuery = generateRandomQuestion();
  159 |
  160 |     console.log(`üîç Searching for non-existent history: "${randomQuery}"`);
  161 |     await frameLocator.locator(Chatbotlocator.Searchbar).clear();
  162 |     await frameLocator.locator(Chatbotlocator.Searchbar).fill(randomQuery);
  163 |     await expect(frameLocator.getByText('◊ú◊ê ◊†◊û◊¶◊ê◊î ◊©◊ô◊ó◊î')).toBeVisible();
  164 |   
  165 |   }
  166 |
  167 |   async CloseHamburgerMenu() {
  168 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
  169 |
  170 |     console.log('‚ùå Closing hamburger menu...');
  171 |     await expect(frameLocator.getByRole('button', { name: 'Close' })).toBeVisible();
  172 |     await frameLocator.getByRole('button', { name: 'Close' }).click();
  173 |   }
  174 |
  175 |   async Newsession() {
  176 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
  177 |
  178 |     console.log('üîÅ Creating new session from hamburger menu...');
  179 |     await frameLocator.getByRole('button', { name: 'icon' }).nth(2).click();
  180 |     await expect(frameLocator.getByTestId('start-new-session')).toBeVisible();
  181 |     await frameLocator.getByTestId('start-new-session').click();
  182 |   }
  183 |
  184 |   async Wait() {
  185 |     const idleMessage = '◊î◊ô◊ô! ◊ú◊ê ◊®◊ê◊ô◊†◊ï ◊§◊¢◊ô◊ú◊ï◊™ ◊ë-10 ◊î◊ì◊ß◊ï◊™ ◊î◊ê◊ó◊®◊ï◊†◊ï◊™. ◊®◊ï◊¶◊î ◊ú◊î◊û◊©◊ô◊ö ◊ë◊©◊ô◊ó◊î? ◊§◊©◊ï◊ò ◊ú◊ó◊• ◊¢◊ú ◊õ◊§◊™◊ï◊® ◊î◊û◊©◊ö ◊©◊ô◊ó◊î ◊ú◊û◊ò◊î.';
  186 |     
  187 |     console.log('‚è±Ô∏è Waiting for 10 minutes to simulate user inactivity...');
  188 |     this.page.setDefaultTimeout(11 * 60 * 1000);
  189 |     await this.page.waitForTimeout(10 * 60 * 1000);
  190 |     
  191 |     console.log('‚úÖ Verifying idle timeout message appears...');
  192 |     await expect(this.page.locator(`text=${idleMessage}`)).toBeVisible();
  193 |   }
  194 |
  195 |   async LikeBtn() {
  196 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
  197 |
  198 |     console.log('üëç Clicking Like button...');
  199 |     await expect(frameLocator.locator(Chatbotlocator.LikeBtn)).toBeVisible();
  200 |     await frameLocator.locator(Chatbotlocator.LikeBtn).click();
  201 |     await expect(frameLocator.locator(`${Chatbotlocator.LikeBtn} img`)).toHaveAttribute('src', /fill='%23008AFC'/);
  202 |   }
  203 |
  204 |   async DisLikeBtn() {
  205 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
  206 |
  207 |     console.log('üëé Clicking Dislike button...');
  208 |     await expect(frameLocator.locator(Chatbotlocator.DisLikeBtn)).toBeVisible();
  209 |     await frameLocator.locator(Chatbotlocator.DisLikeBtn).click();
  210 |     await expect(frameLocator.locator(`${Chatbotlocator.DisLikeBtn} img`)).toHaveAttribute('src', /fill='%23008AFC'/);
  211 |   }
  212 |
  213 |   async CopyBtn() {
  214 |     const frameLocator = this.page.frameLocator(Chatbotlocator.iframeName);
  215 |
  216 |     console.log('üìã Clicking Copy button...');
  217 |     await expect(frameLocator.locator(Chatbotlocator.Copybtn)).toBeVisible();
  218 |     await frameLocator.locator(Chatbotlocator.Copybtn).click();
  219 |   }
  220 |
  221 |   async PredefinedBtnClick(testInfo: TestInfo) {
```